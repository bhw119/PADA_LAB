# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
Helpfulness =~ system1 + system2
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
# ğŸ“Œ ìš”ì¸ ì ì¬ëŸ‰(Factor Loadings)
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings+Rating
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
# ğŸ“Œ ìš”ì¸ ì ì¬ëŸ‰(Factor Loadings)
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled_double.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
# ğŸ“Œ ìš”ì¸ ì ì¬ëŸ‰(Factor Loadings)
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled_double.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
lavInspect(fit, "converged")
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled_double.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
apply(df[, c("Is_Photo", "Title_Length", "Text_Length", "Time_Lapsed", "Deviation_Of_Star_Ratings")], 2, var)
apply(df[, c("FOG_Index", "Flesch_Reading_Ease", "Depth", "Breadth", "Valence", "Arousal", "Interaction")], 2, var)
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled_double.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
print(items)
factor_loadings <- parameterEstimates(fit, standardized = TRUE)
print(factor_loadings)
print(AVE_CR)
# ğŸ“Œ ì ì¬ë³€ìˆ˜ ì¶”ì¶œ
df$Factor1 <- lavPredict(fit)[, "system1"]
df$Factor2 <- lavPredict(fit)[, "system2"]
df$Helpfulness <- round(df$Helpfulness)  # ë°˜ì˜¬ë¦¼ í›„ ì •ìˆ˜ ë³€í™˜
df$Helpfulness <- as.integer(df$Helpfulness)
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©
zinb_model <- zeroinfl(Helpfulness ~ Factor1 + Factor2,
data = df,
dist = "negbin",
link = "logit")
# ğŸ“Œ ZINB ëª¨ë¸ ì í•©ë„ í‰ê°€
AIC_value <- AIC(zinb_model)
BIC_value <- BIC(zinb_model)
pseudo_r2 <- pR2(zinb_model)
logLik_value <- logLik(zinb_model)
# ğŸ“Œ ë‹¤ì¤‘ê³µì„ ì„± í™•ì¸ (VIF ëŒ€ì‹  ìƒê´€ê³„ìˆ˜ í–‰ë ¬ í™•ì¸)
cor_matrix <- cor(df[, c("Factor1", "Factor2")], use = "complete.obs")
print(cor_matrix)
# ğŸ“Œ VIF ëŒ€ì²´ ë°©ë²• (glm ì‚¬ìš©)
glm_model <- glm(Helpfulness ~ Factor1 + Factor2, data = df, family = poisson)
vif_values <- vif(glm_model)
print(vif_values)
# ğŸ“Œ ê²°ê³¼ ì¶œë ¥
print(summary(zinb_model))
print(AIC_value)
print(BIC_value)
print(pseudo_r2)
print(logLik_value)
# ğŸ“Œ SEM ì‹œê°í™” (êµ¬ì¡°ë°©ì •ì‹ ë‹¤ì´ì–´ê·¸ë¨)
if (lavInspect(fit, "converged")) {
semPaths(fit, "std", layout = "tree", whatLabels = "std", edge.label.cex = 1.2)
} else {
print("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•„ì„œ ì‹œê°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
}
library(lavaan)
library(pscl)
library(semPlot)
library(car)  # VIF ê³„ì‚°ì„ ìœ„í•´ ì¶”ê°€
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
df <- read.csv("C:/Users/Administrator/Desktop/PADA_LAB/êµ¬ì¡°ë°©ì •ì‹/Count_SEM/scaled_data/amazon_scaled_double.csv")
# SEM ëª¨ë¸ ì •ì˜
model <- '
system1 =~ Is_Photo + Title_Length + Text_Length + Time_Lapsed+ Deviation_Of_Star_Ratings
system2 =~ FOG_Index + Flesch_Reading_Ease + Depth + Breadth + Valence + Arousal + Interaction
'
# SEM ëª¨ë¸ ì í•©
fit <- sem(model, data = df, estimator = "MLR")
# ğŸ“Œ SEM ì í•©ë„ ì§€í‘œ í™•ì¸
if (lavInspect(fit, "converged")) {
fit_measures <- fitMeasures(fit, c("cfi", "tli", "rmsea", "srmr"))
print(fit_measures)
} else {
stop("ëª¨ë¸ì´ ìˆ˜ë ´í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë ´ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.")
}
# ğŸ“Œ AVE & CR ê³„ì‚°
latent_vars <- c("system1", "system2")
AVE_CR <- data.frame(Variable = latent_vars, AVE = NA, CR = NA)
for (i in 1:length(latent_vars)) {
items <- subset(factor_loadings, lhs == latent_vars[i] & op == "=~" & !is.na(std.all))
print(item)
if (nrow(items) > 0) {  # ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ ê³„ì‚°
loadings <- items$std.all
AVE_CR$AVE[i] <- mean(loadings^2)  # AVE
CR_numerator <- sum(loadings)^2
CR_denominator <- CR_numerator + sum(items$se^2)
AVE_CR$CR[i] <- ifelse(CR_denominator > 0, CR_numerator / CR_denominator, NA)  # 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€
} else {
AVE_CR$AVE[i] <- NA
AVE_CR$CR[i] <- NA
}
}
